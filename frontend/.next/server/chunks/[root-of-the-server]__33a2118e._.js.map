{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///I:/Project%20Coding/granime.v2/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///I:/Project%20Coding/granime.v2/src/lib/supabaseServer.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function supabaseServer() {\r\n  const cookieStore = await cookies();\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll();\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) =>\r\n              cookieStore.set(name, value, options)\r\n            );\r\n          } catch {\r\n            // The `setAll` method was called from a Server Component.\r\n            // This can be ignored if you have middleware refreshing\r\n            // user sessions.\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,OAAO,IAAA,iMAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///I:/Project%20Coding/granime.v2/src/app/api/user/initialize/route.ts"],"sourcesContent":["import prisma from \"@/lib/prisma\";\r\nimport { supabaseServer } from \"@/lib/supabaseServer\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const supabase = await supabaseServer();\r\n\r\n    const {\r\n      data: { session },\r\n      error: sessionError,\r\n    } = await supabase.auth.getSession();\r\n\r\n    if (sessionError || !session?.user) {\r\n      return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n\r\n    const userId = session.user.id;\r\n    const userEmail = session.user.email;\r\n    const userName = userEmail?.split(\"@\")[0] || \"NPC\";\r\n\r\n    const existingUser = await prisma.user.findUnique({\r\n      where: { id: userId },\r\n    });\r\n\r\n    if (existingUser) {\r\n      return NextResponse.json({\r\n        message: \"User already initialized\",\r\n        alreadyExists: true,\r\n      });\r\n    }\r\n\r\n    await prisma.$transaction(async (tx: any) => {\r\n      await tx.user.create({\r\n        data: {\r\n          id: userId,\r\n          email: userEmail,\r\n          username: userName,\r\n          role: \"user\",\r\n          createdAt: new Date(),\r\n          updatedAt: new Date(),\r\n        },\r\n      });\r\n    });\r\n\r\n    console.log(`âœ… User initialized: ${userEmail} (${userId})`);\r\n\r\n    return NextResponse.json({\r\n      message: \"User initialized successfully\",\r\n      userId,\r\n      username: userName,\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error initializing user:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Failed to initialize user\", error: String(error) },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,gJAAc;QAErC,MAAM,EACJ,MAAM,EAAE,OAAO,EAAE,EACjB,OAAO,YAAY,EACpB,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;QAElC,IAAI,gBAAgB,CAAC,SAAS,MAAM;YAClC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,SAAS,QAAQ,IAAI,CAAC,EAAE;QAC9B,MAAM,YAAY,QAAQ,IAAI,CAAC,KAAK;QACpC,MAAM,WAAW,WAAW,MAAM,IAAI,CAAC,EAAE,IAAI;QAE7C,MAAM,eAAe,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAChD,OAAO;gBAAE,IAAI;YAAO;QACtB;QAEA,IAAI,cAAc;YAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,eAAe;YACjB;QACF;QAEA,MAAM,iIAAM,CAAC,YAAY,CAAC,OAAO;YAC/B,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBACnB,MAAM;oBACJ,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,MAAM;oBACN,WAAW,IAAI;oBACf,WAAW,IAAI;gBACjB;YACF;QACF;QAEA,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,UAAU,EAAE,EAAE,OAAO,CAAC,CAAC;QAE1D,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA,UAAU;QACZ;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAA6B,OAAO,OAAO;QAAO,GAC7D;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}